<div class="container-fluid mt-4">
    <div class="card shadow rounded-4">
      <!-- Header with title and search -->
      <div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center px-4 py-3">
        <h4 class="mb-0 fw-bold text-danger">
          <i class="fas fa-users me-2"></i> User Management
        </h4>
        <div class="w-25">
          <input type="text" class="form-control rounded-pill px-3" placeholder="ðŸ” Search users..."
                 [(ngModel)]="searchQuery" (input)="applyFilter()">
        </div>
      </div>
  
      <!-- Table & content -->
      <div class="card-body px-4 py-3 bg-light rounded-bottom">
        <!-- Loading spinner -->
        <div *ngIf="isLoading" class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
  
        <!-- Error message -->
        <div *ngIf="errorMessage" class="alert alert-danger">
          {{ errorMessage }}
        </div>
  
        <!-- User Table -->
        <div *ngIf="!isLoading" class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead class="text-primary text-uppercase fw-semibold bg-white">
              <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Status</th>
                <th>Role</th>
                <th class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of filteredUsers">
                <td>{{ user.username }}</td>
                <td>{{ user.email }}</td>
                <td>
                  <span class="badge px-3 py-2 rounded-pill" 
                        [ngClass]="user.flag ? 'bg-success' : 'bg-secondary'">
                    {{ user.flag ? 'Active' : 'Inactive' }}
                  </span>
                </td>
                <td>
                  <select class="form-select form-select-sm rounded-pill"
                          [(ngModel)]="user.roles[0]"  
                          (change)="updateRole(user)">
                    <option value="ROLE_LOGISTIQUE">Logistic</option>
                    <option value="ROLE_MARKETING">Marketing</option>
                    <option value="ROLE_ADMINISTRATOR">Admin</option>
                  </select>
                </td>
                <td class="text-center">
                  <button class="btn btn-sm btn-outline-success rounded-pill me-2"
                          (click)="toggleUserStatus(user)">
                    <i class="fas" 
                       [ngClass]="user.flag ? 'fa-user-slash' : 'fa-user-check'"></i>
                    {{ user.flag ? 'Deactivate' : 'Activate' }}
                  </button>
                  <button class="btn btn-sm btn-outline-danger rounded-pill"
                          (click)="deleteUser(user.codeUser)">
                    <i class="fas fa-trash"></i> Delete
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
  
      </div>
    </div>
  </div>
  